# -*- coding: utf-8 -*-
"""
Created on Wed Nov 17 16:48:19 2021

@author: user
"""

import os
import numpy as np
from openpyxl import load_workbook, Workbook

#########################################

station_path = '/media/ubuntu/My Passport/NCDR/Data/test_ablation/station_data'
#station_path = 'E:/tech/ncdr/station_test'

Result = 'Result/typhoon_day_2015.xlsx'


#https://zh.wikipedia.org/wiki/%E4%B8%AD%E5%A4%AE%E6%B0%A3%E8%B1%A1%E5%B1%80%E6%9C%89%E7%99%BC%E4%BD%88%E8%AD%A6%E5%A0%B1%E7%9A%84%E9%A2%B1%E9%A2%A8%E5%88%97%E8%A1%A8
typhoon_date_list = [
    
    '20100830','20100831','20100901','20100902','20100909'
    '20100910','20100917','20100918','20100920','20101021'
    '20101022','20101023'
    
    '20110509','20110510','20110527','20110528','20110623',
    '20110624','20110625','20110804','20110805','20110806',
    '20110827','20110828','20110829','20110830','20110831',
    
    '20120619','20120620','20120621','20120628','20120629',
    
    '20120730','20120731','20120801','20120802','20120803',
    '20120806','20120807','20120814','20120815','20120821',
    '20120822','20120823','20120824','20120825','20120826',
    '20120827','20120828','20120927','20120928'
    
    '20130711','20130712','20130713','20130717','20130718',
    '20130820','20130821','20130822','20130827','20130828',
    '20130829','20130919','20130920','20130921','20130922',
    '20131004','20131005','20131006','20131007'
    
    '20140614','20140615','20140721','20140722','20140723',
    '20140919','20140920','20140921','20140922'
    
    '20150510','20150511','20150709','20150710','20150711',
    '20150706','20150707','20150708','20150806','20150807',
    '20150808','20150809','20150820','20150821','20150822',
    '20150823','20150927','20150928','20150929'
    
    '20160706','20160707','20160708','20160912','20160913',
    '20160914','20160915','20160916','20160917','20160918',
    '20160925','20160928','20161005','20161006'
    
    ]

##############################################

print("[INFO] loading special station")


wb = Workbook()
sheet = wb.create_sheet("daily_afternoon_rainfall", 0)
count_true = 0
count_false = 0


for year in os.listdir(station_path):
    #print(file)
    year_dir = station_path + "/" + year
    for month in os.listdir(year_dir):
        month_dir = year_dir + "/" + month
        for date in os.listdir(month_dir):
            
            print(date)
            
            if date in typhoon_date_list:
                print("in")
                count_true+=1
                sheet.append([date,0])
            else:
                #print("not in")
                count_false+=1
                sheet.append([date,1])
                
wb.save(Result)
print(count_true)
print(count_false)